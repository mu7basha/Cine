using Gtk 4.0;
using Adw 1;

template $Preferences: Adw.Dialog {
	title: _("Preferences");
	content-width: 491;

	Adw.ToolbarView {
		[top]
		Adw.HeaderBar {}

		content: Adw.Clamp {
			Adw.PreferencesPage prefs_page {
				Adw.PreferencesGroup {
					Adw.SwitchRow open_new_row {
						title: _("Open New Window for New Files");
					}

					Adw.ActionRow sub_color_row {
						title: _("Subtitle Color");
						activatable: true;
						activatable-widget: color_dialog_button;

						[suffix]
						ColorDialogButton color_dialog_button {
							valign: center;
						}

						[suffix]
						Button reset_sub_color {
							valign: center;
							icon-name: "edit-undo-symbolic";
							tooltip-text: _("Reset");
							margin-start: 8;

							styles [
								"circular",
							]
						}
					}

					Adw.ActionRow font_row {
						title: _("Subtitle Font");
						activatable: true;

						MenuButton {
							icon-name: "info-outline-symbolic";
							valign: center;

							styles [
								"flat",
							]

							popover: Popover {
								Label {
									label: _("Some fonts may not work");

									styles [
										"warning",
									]
								}
							};
						}

						[suffix]
						Label font_label {
							label: "$FONT";

							styles [
								"heading",
							]
						}

						Button reset_sub_font {
							valign: center;
							icon-name: "edit-undo-symbolic";
							tooltip-text: _("Reset");
							margin-start: 8;

							styles [
								"circular",
							]
						}
					}

					Adw.SpinRow subtitle_scale_row {
						title: _("Subtitle Scale");
						digits: 2;

						adjustment: Adjustment {
							lower: 0.1;
							upper: 3;
							step-increment: 0.05;
						};
					}

					Adw.EntryRow subtitle_lang_row {
						title: _("Preferred Subtitle Languages");
						tooltip-text: _("Example: pt-BR,en,es");
					}

					Adw.EntryRow audio_lang_row {
						title: _("Preferred Audio Languages");
						tooltip-text: _("Example: pt-BR,en,es");
					}

					Adw.SwitchRow normalize_volume_row {
						title: _("Normalize Volume");
					}

					Adw.SwitchRow save_position_row {
						title: _("Save Video Position on Close");
						subtitle: _("This also save options like brightness, subtitle delay, etc.");

						[prefix]
						MenuButton {
							icon-name: "info-outline-symbolic";
							valign: center;

							styles [
								"flat",
							]

							popover: Popover {
								styles [
									"popover-scrolled",
								]

								width-request: 360;
								height-request: 60;

								ScrolledWindow {
									Label {
										label: _("This requires flatpak permission to read the folder where the video is stored");
										wrap: true;
										justify: center;

										styles [
											"warning",
										]
									}
								}
							};
						}
					}
				}
			}
		};
	}
}
